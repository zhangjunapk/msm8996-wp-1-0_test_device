#===============================================================================
#
# SecureMSM APIs
#
# GENERAL DESCRIPTION
#    build script
#
# Copyright (c) 2013 by Qualcomm Technologies, Incorporated.
# All Rights Reserved.
# QUALCOMM Proprietary/GTDR
#
#-------------------------------------------------------------------------------
#
#  $Header: //components/rel/core.tz/1.0.3.c1/securemsm/accesscontrol/build/ac.api#1 $
#  $DateTime: 2016/12/02 01:46:26 $
#  $Author: pwbldsvc $
#  $Change: 11896995 $
#                      EDIT HISTORY FOR FILE
#                      
#  This section contains comments describing changes made to the module.
#  Notice that changes are listed in reverse chronological order.
#  
# when       who     what, where, why
# --------   ---     ---------------------------------------------------------
#
#===============================================================================
import os

Import('env')

if os.path.exists(env.subst('${INC_ROOT}/core/securemsm/accesscontrol/cfg/${MSM_ID}')):
   env.Replace(AC_MSM_ID = env['MSM_ID'])
else:
   env.Replace(AC_MSM_ID = 'stubs')
   env.PrintWarning("Access control not implemented... using stubs.")
      
if env.has_key('TZOS_IMAGE'):
    env.Replace(AC_IMG = 'tz')
elif env.has_key('HYPERVISOR_IMAGE'):
    env.Replace(AC_IMG = 'hyp')
else:
    Return();

#-------------------------------------------------------------------------------
# Publish Protected APIs
#-------------------------------------------------------------------------------
env.PublishProtectedApi('AC', [
   '${INC_ROOT}/core/securemsm/accesscontrol/src/smmu',
   '${INC_ROOT}/core/securemsm/accesscontrol/src/components/xpu',
   '${INC_ROOT}/core/securemsm/accesscontrol/api',
   '${INC_ROOT}/core/securemsm/accesscontrol/cfg/${AC_MSM_ID}',
   '${INC_ROOT}/core/securemsm/accesscontrol/cfg/${AC_MSM_ID}/${AC_IMG}',
])

#-------------------------------------------------------------------------------
# Publish Restricted APIs
#-------------------------------------------------------------------------------
env.PublishRestrictedApi('AC', [
   '${INC_ROOT}/core/securemsm/accesscontrol/api',
   '${INC_ROOT}/core/securemsm/accesscontrol/src/components/xpu',
   '${INC_ROOT}/core/securemsm/accesscontrol/src/components/vmidmt',
])

env.LoadAPIUnits()